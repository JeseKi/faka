{"openapi":"3.1.0","info":{"title":"Backend Template (Auth + DB + Example)","version":"0.1.0"},"paths":{"/api/auth/login":{"post":{"tags":["auth"],"summary":"Login For Access Token","operationId":"login_for_access_token_api_auth_login_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/UserLogin"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/TokenResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/auth/register":{"post":{"tags":["auth"],"summary":"Register User","operationId":"register_user_api_auth_register_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/UserCreate"}}},"required":true},"responses":{"201":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/UserProfile"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/auth/refresh":{"post":{"tags":["auth"],"summary":"Refresh Access Token","operationId":"refresh_access_token_api_auth_refresh_post","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/TokenResponse"}}}}},"security":[{"OAuth2PasswordBearer":[]}]}},"/api/auth/profile":{"get":{"tags":["auth"],"summary":"Get Profile","operationId":"get_profile_api_auth_profile_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/UserProfile"}}}}},"security":[{"OAuth2PasswordBearer":[]}]},"put":{"tags":["auth"],"summary":"Update Profile","operationId":"update_profile_api_auth_profile_put","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/UserUpdate"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/UserProfile"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}},"security":[{"OAuth2PasswordBearer":[]}]}},"/api/auth/password":{"put":{"tags":["auth"],"summary":"Change Current User Password","operationId":"change_current_user_password_api_auth_password_put","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/PasswordChange"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}},"security":[{"OAuth2PasswordBearer":[]}]}},"/api/example/ping":{"get":{"tags":["example"],"summary":"Ping","operationId":"ping_api_example_ping_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"additionalProperties":{"type":"string"},"type":"object","title":"Response Ping Api Example Ping Get"}}}}}}},"/api/example/items":{"post":{"tags":["example"],"summary":"Create Item","operationId":"create_item_api_example_items_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ItemCreate"}}},"required":true},"responses":{"201":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ItemOut"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/example/items/{item_id}":{"get":{"tags":["example"],"summary":"Get Item","operationId":"get_item_api_example_items__item_id__get","parameters":[{"name":"item_id","in":"path","required":true,"schema":{"type":"integer","title":"Item Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ItemOut"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/cards":{"post":{"tags":["cards"],"summary":"Create Card","description":"创建充值卡（管理员权限）","operationId":"create_card_api_cards_post","security":[{"OAuth2PasswordBearer":[]}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/CardCreate"}}}},"responses":{"201":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/CardOut"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"get":{"tags":["cards"],"summary":"List Cards","description":"获取充值卡列表（管理员权限）","operationId":"list_cards_api_cards_get","security":[{"OAuth2PasswordBearer":[]}],"parameters":[{"name":"include_inactive","in":"query","required":false,"schema":{"type":"boolean","default":false,"title":"Include Inactive"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/CardOut"},"title":"Response List Cards Api Cards Get"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/cards/{card_id}":{"get":{"tags":["cards"],"summary":"Get Card","description":"获取单个充值卡（管理员权限）","operationId":"get_card_api_cards__card_id__get","security":[{"OAuth2PasswordBearer":[]}],"parameters":[{"name":"card_id","in":"path","required":true,"schema":{"type":"integer","title":"Card Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/CardOut"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"put":{"tags":["cards"],"summary":"Update Card","description":"更新充值卡（管理员权限）","operationId":"update_card_api_cards__card_id__put","security":[{"OAuth2PasswordBearer":[]}],"parameters":[{"name":"card_id","in":"path","required":true,"schema":{"type":"integer","title":"Card Id"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/CardUpdate"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/CardOut"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"delete":{"tags":["cards"],"summary":"Delete Card","description":"删除充值卡（管理员权限）","operationId":"delete_card_api_cards__card_id__delete","security":[{"OAuth2PasswordBearer":[]}],"parameters":[{"name":"card_id","in":"path","required":true,"schema":{"type":"integer","title":"Card Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/cards/{card_name}/stock":{"get":{"tags":["cards"],"summary":"Get Card Stock","description":"获取充值卡库存数量（管理员权限）","operationId":"get_card_stock_api_cards__card_name__stock_get","security":[{"OAuth2PasswordBearer":[]}],"parameters":[{"name":"card_name","in":"path","required":true,"schema":{"type":"string","title":"Card Name"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/cards/{card_name}/generate-codes":{"post":{"tags":["cards"],"summary":"Generate Activation Codes For Card","description":"为指定充值卡批量生成卡密（管理员权限）","operationId":"generate_activation_codes_for_card_api_cards__card_name__generate_codes_post","security":[{"OAuth2PasswordBearer":[]}],"parameters":[{"name":"card_name","in":"path","required":true,"schema":{"type":"string","title":"Card Name"}},{"name":"count","in":"query","required":false,"schema":{"type":"integer","default":10,"title":"Count"}}],"responses":{"201":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/activation-codes/generate":{"post":{"tags":["activation-codes"],"summary":"Generate Activation Codes","description":"批量生成卡密（管理员权限）","operationId":"generate_activation_codes_api_activation_codes_generate_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ActivationCodeCreate"}}},"required":true},"responses":{"201":{"description":"Successful Response","content":{"application/json":{"schema":{"items":{"$ref":"#/components/schemas/ActivationCodeOut"},"type":"array","title":"Response Generate Activation Codes Api Activation Codes Generate Post"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}},"security":[{"OAuth2PasswordBearer":[]}]}},"/api/activation-codes/{card_name}":{"get":{"tags":["activation-codes"],"summary":"List Activation Codes","description":"获取指定充值卡的所有卡密（管理员权限）","operationId":"list_activation_codes_api_activation_codes__card_name__get","security":[{"OAuth2PasswordBearer":[]}],"parameters":[{"name":"card_name","in":"path","required":true,"schema":{"type":"string","title":"Card Name"}},{"name":"include_used","in":"query","required":false,"schema":{"type":"boolean","default":false,"title":"Include Used"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/ActivationCodeOut"},"title":"Response List Activation Codes Api Activation Codes  Card Name  Get"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"delete":{"tags":["activation-codes"],"summary":"Delete Activation Codes","description":"删除指定充值卡的所有卡密（管理员权限）","operationId":"delete_activation_codes_api_activation_codes__card_name__delete","security":[{"OAuth2PasswordBearer":[]}],"parameters":[{"name":"card_name","in":"path","required":true,"schema":{"type":"string","title":"Card Name"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/activation-codes/{card_name}/count":{"get":{"tags":["activation-codes"],"summary":"Count Activation Codes","description":"获取指定充值卡的卡密数量（管理员权限）","operationId":"count_activation_codes_api_activation_codes__card_name__count_get","security":[{"OAuth2PasswordBearer":[]}],"parameters":[{"name":"card_name","in":"path","required":true,"schema":{"type":"string","title":"Card Name"}},{"name":"only_unused","in":"query","required":false,"schema":{"type":"boolean","default":true,"title":"Only Unused"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/sales/purchase":{"post":{"tags":["sales"],"summary":"Purchase Card","description":"购买充值卡（前台用户，无需登录）","operationId":"purchase_card_api_sales_purchase_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/SaleCreate"}}},"required":true},"responses":{"201":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/SaleOut"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/sales":{"get":{"tags":["sales"],"summary":"List Sales","description":"获取销售记录列表（管理员权限）","operationId":"list_sales_api_sales_get","security":[{"OAuth2PasswordBearer":[]}],"parameters":[{"name":"limit","in":"query","required":false,"schema":{"type":"integer","default":100,"title":"Limit"}},{"name":"offset","in":"query","required":false,"schema":{"type":"integer","default":0,"title":"Offset"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/SaleOut"},"title":"Response List Sales Api Sales Get"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/sales/stats":{"get":{"tags":["sales"],"summary":"Get Sales Stats","description":"获取销售统计信息（管理员权限）","operationId":"get_sales_stats_api_sales_stats_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}},"security":[{"OAuth2PasswordBearer":[]}]}},"/api/sales/user/{user_email}":{"get":{"tags":["sales"],"summary":"Get User Sales","description":"获取指定用户的购买记录（管理员权限）","operationId":"get_user_sales_api_sales_user__user_email__get","security":[{"OAuth2PasswordBearer":[]}],"parameters":[{"name":"user_email","in":"path","required":true,"schema":{"type":"string","title":"User Email"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/SaleOut"},"title":"Response Get User Sales Api Sales User  User Email  Get"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/orders/verify":{"post":{"tags":["orders"],"summary":"Verify Activation Code","description":"验证卡密并创建订单（外部服务调用，无需登录）","operationId":"verify_activation_code_api_orders_verify_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/OrderVerify"}}},"required":true},"responses":{"201":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/OrderOut"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/orders":{"get":{"tags":["orders"],"summary":"List Orders","description":"获取订单列表（工作人员权限）","operationId":"list_orders_api_orders_get","security":[{"OAuth2PasswordBearer":[]}],"parameters":[{"name":"status_filter","in":"query","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Status Filter"}},{"name":"limit","in":"query","required":false,"schema":{"type":"integer","default":100,"title":"Limit"}},{"name":"offset","in":"query","required":false,"schema":{"type":"integer","default":0,"title":"Offset"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/OrderOut"},"title":"Response List Orders Api Orders Get"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/orders/pending":{"get":{"tags":["orders"],"summary":"List Pending Orders","description":"获取待处理订单列表（工作人员权限）","operationId":"list_pending_orders_api_orders_pending_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"items":{"$ref":"#/components/schemas/OrderOut"},"type":"array","title":"Response List Pending Orders Api Orders Pending Get"}}}}},"security":[{"OAuth2PasswordBearer":[]}]}},"/api/orders/{order_id}":{"get":{"tags":["orders"],"summary":"Get Order","description":"获取单个订单（工作人员权限）","operationId":"get_order_api_orders__order_id__get","security":[{"OAuth2PasswordBearer":[]}],"parameters":[{"name":"order_id","in":"path","required":true,"schema":{"type":"integer","title":"Order Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/OrderOut"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/orders/{order_id}/complete":{"put":{"tags":["orders"],"summary":"Complete Order","description":"完成订单（工作人员权限）","operationId":"complete_order_api_orders__order_id__complete_put","security":[{"OAuth2PasswordBearer":[]}],"parameters":[{"name":"order_id","in":"path","required":true,"schema":{"type":"integer","title":"Order Id"}}],"requestBody":{"content":{"application/json":{"schema":{"anyOf":[{"$ref":"#/components/schemas/OrderUpdate"},{"type":"null"}],"title":"Order Data"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/OrderOut"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/orders/stats":{"get":{"tags":["orders"],"summary":"Get Order Stats","description":"获取订单统计信息（工作人员权限）","operationId":"get_order_stats_api_orders_stats_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}},"security":[{"OAuth2PasswordBearer":[]}]}}},"components":{"schemas":{"ActivationCodeCreate":{"properties":{"card_name":{"type":"string","maxLength":100,"minLength":1,"title":"Card Name"},"count":{"type":"integer","maximum":1000.0,"exclusiveMinimum":0.0,"title":"Count"}},"type":"object","required":["card_name","count"],"title":"ActivationCodeCreate"},"ActivationCodeOut":{"properties":{"id":{"type":"integer","title":"Id"},"card_name":{"type":"string","title":"Card Name"},"code":{"type":"string","title":"Code"},"is_used":{"type":"boolean","title":"Is Used"},"created_at":{"type":"string","format":"date-time","title":"Created At"},"used_at":{"anyOf":[{"type":"string","format":"date-time"},{"type":"null"}],"title":"Used At"}},"type":"object","required":["id","card_name","code","is_used","created_at"],"title":"ActivationCodeOut"},"CardCreate":{"properties":{"name":{"type":"string","maxLength":100,"minLength":1,"title":"Name"},"description":{"type":"string","maxLength":500,"minLength":1,"title":"Description"},"price":{"type":"number","exclusiveMinimum":0.0,"title":"Price"},"is_active":{"type":"boolean","title":"Is Active","default":true}},"type":"object","required":["name","description","price"],"title":"CardCreate"},"CardOut":{"properties":{"id":{"type":"integer","title":"Id"},"name":{"type":"string","title":"Name"},"description":{"type":"string","title":"Description"},"price":{"type":"number","title":"Price"},"is_active":{"type":"boolean","title":"Is Active"}},"type":"object","required":["id","name","description","price","is_active"],"title":"CardOut"},"CardUpdate":{"properties":{"name":{"anyOf":[{"type":"string","maxLength":100,"minLength":1},{"type":"null"}],"title":"Name"},"description":{"anyOf":[{"type":"string","maxLength":500,"minLength":1},{"type":"null"}],"title":"Description"},"price":{"anyOf":[{"type":"number","exclusiveMinimum":0.0},{"type":"null"}],"title":"Price"},"is_active":{"anyOf":[{"type":"boolean"},{"type":"null"}],"title":"Is Active"}},"type":"object","title":"CardUpdate"},"HTTPValidationError":{"properties":{"detail":{"items":{"$ref":"#/components/schemas/ValidationError"},"type":"array","title":"Detail"}},"type":"object","title":"HTTPValidationError"},"ItemCreate":{"properties":{"name":{"type":"string","maxLength":100,"minLength":1,"title":"Name"}},"type":"object","required":["name"],"title":"ItemCreate"},"ItemOut":{"properties":{"id":{"type":"integer","title":"Id"},"name":{"type":"string","title":"Name"}},"type":"object","required":["id","name"],"title":"ItemOut"},"OrderOut":{"properties":{"id":{"type":"integer","title":"Id"},"activation_code":{"type":"string","title":"Activation Code"},"status":{"type":"string","title":"Status"},"created_at":{"type":"string","format":"date-time","title":"Created At"},"completed_at":{"anyOf":[{"type":"string","format":"date-time"},{"type":"null"}],"title":"Completed At"},"remarks":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Remarks"}},"type":"object","required":["id","activation_code","status","created_at"],"title":"OrderOut"},"OrderUpdate":{"properties":{"status":{"anyOf":[{"type":"string","pattern":"^(pending|completed)$"},{"type":"null"}],"title":"Status"},"remarks":{"anyOf":[{"type":"string","maxLength":1000},{"type":"null"}],"title":"Remarks"}},"type":"object","title":"OrderUpdate"},"OrderVerify":{"properties":{"code":{"type":"string","maxLength":36,"minLength":1,"title":"Code"}},"type":"object","required":["code"],"title":"OrderVerify"},"PasswordChange":{"properties":{"old_password":{"type":"string","title":"Old Password"},"new_password":{"type":"string","minLength":8,"title":"New Password"}},"type":"object","required":["old_password","new_password"],"title":"PasswordChange"},"SaleCreate":{"properties":{"card_name":{"type":"string","maxLength":100,"minLength":1,"title":"Card Name"},"user_email":{"type":"string","maxLength":255,"minLength":1,"title":"User Email"}},"type":"object","required":["card_name","user_email"],"title":"SaleCreate"},"SaleOut":{"properties":{"id":{"type":"integer","title":"Id"},"activation_code":{"type":"string","title":"Activation Code"},"user_email":{"type":"string","title":"User Email"},"sale_price":{"type":"number","title":"Sale Price"},"purchased_at":{"type":"string","format":"date-time","title":"Purchased At"}},"type":"object","required":["id","activation_code","user_email","sale_price","purchased_at"],"title":"SaleOut"},"TokenResponse":{"properties":{"access_token":{"type":"string","title":"Access Token"},"refresh_token":{"type":"string","title":"Refresh Token"},"token_type":{"type":"string","title":"Token Type","default":"bearer"}},"type":"object","required":["access_token","refresh_token"],"title":"TokenResponse"},"UserCreate":{"properties":{"username":{"type":"string","maxLength":50,"minLength":3,"title":"Username"},"email":{"type":"string","format":"email","title":"Email"},"password":{"type":"string","minLength":8,"title":"Password"}},"type":"object","required":["username","email","password"],"title":"UserCreate"},"UserLogin":{"properties":{"username":{"type":"string","title":"Username"},"password":{"type":"string","title":"Password"}},"type":"object","required":["username","password"],"title":"UserLogin"},"UserProfile":{"properties":{"id":{"type":"integer","title":"Id"},"username":{"type":"string","title":"Username"},"email":{"type":"string","format":"email","title":"Email"},"name":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Name"},"role":{"type":"string","title":"Role"},"status":{"type":"string","title":"Status"}},"type":"object","required":["id","username","email","role","status"],"title":"UserProfile"},"UserUpdate":{"properties":{"email":{"anyOf":[{"type":"string","format":"email"},{"type":"null"}],"title":"Email"},"name":{"anyOf":[{"type":"string","maxLength":100},{"type":"null"}],"title":"Name"}},"type":"object","title":"UserUpdate"},"ValidationError":{"properties":{"loc":{"items":{"anyOf":[{"type":"string"},{"type":"integer"}]},"type":"array","title":"Location"},"msg":{"type":"string","title":"Message"},"type":{"type":"string","title":"Error Type"}},"type":"object","required":["loc","msg","type"],"title":"ValidationError"}},"securitySchemes":{"OAuth2PasswordBearer":{"type":"oauth2","flows":{"password":{"scopes":{},"tokenUrl":"/api/auth/login"}}}}}}